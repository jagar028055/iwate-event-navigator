<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid ETL Test</title>
</head>
<body>
    <h1>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ETLã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆ</h1>
    <button onclick="testHybridETL()">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
    <div id="output"></div>

    <script type="module">
        // Import the service
        import { hybridETLService } from './services/hybridETLService.js';
        
        window.testHybridETL = async function() {
            const output = document.getElementById('output');
            output.innerHTML = '<p>ğŸš€ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</p>';
            
            try {
                console.log('ğŸš€ Starting hybrid ETL test...');
                const startTime = Date.now();
                
                const result = await hybridETLService.fetchIwateEvents();
                const executionTime = Date.now() - startTime;
                
                console.log('âœ… Test completed successfully!');
                console.log('Events:', result.events);
                console.log('Sources:', result.sources);
                
                let html = `
                    <h2>âœ… ãƒ†ã‚¹ãƒˆæˆåŠŸ!</h2>
                    <p><strong>å®Ÿè¡Œæ™‚é–“:</strong> ${executionTime}ms</p>
                    <p><strong>å–å¾—ã‚¤ãƒ™ãƒ³ãƒˆæ•°:</strong> ${result.events.length}</p>
                    <p><strong>ä½¿ç”¨ã‚½ãƒ¼ã‚¹æ•°:</strong> ${result.sources.length}</p>
                `;
                
                if (result.events.length > 0) {
                    html += '<h3>ğŸ“… å–å¾—ã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆ (æœ€åˆã®5ä»¶):</h3><ul>';
                    result.events.slice(0, 5).forEach(event => {
                        html += `<li><strong>${event.title}</strong><br>
                                 æ—¥ä»˜: ${event.date}<br>
                                 å ´æ‰€: ${event.locationName}<br>
                                 ã‚«ãƒ†ã‚´ãƒª: ${event.category}</li>`;
                    });
                    html += '</ul>';
                }
                
                if (result.sources.length > 0) {
                    html += '<h3>ğŸ”— ä½¿ç”¨ã•ã‚ŒãŸã‚½ãƒ¼ã‚¹:</h3><ul>';
                    result.sources.forEach(source => {
                        html += `<li>${source.name} (${source.type})</li>`;
                    });
                    html += '</ul>';
                }
                
                output.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ Test failed:', error);
                output.innerHTML = `
                    <h2>âŒ ãƒ†ã‚¹ãƒˆå¤±æ•—</h2>
                    <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };
    </script>
</body>
</html>