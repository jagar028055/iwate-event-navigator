# 岩手イベントナビゲーター 機能仕様書

## 1. システム概要

### 1.1 システム名
岩手イベントナビゲーター（Iwate Event Navigator）

### 1.2 システム目的
岩手県内で開催される各種イベント情報を収集、検索、表示し、ユーザーが地図上で直感的にイベントを発見できるWebアプリケーション

### 1.3 対象ユーザー
- 岩手県在住者
- 岩手県への観光客
- イベント主催者
- 地域情報に関心のある人

## 2. 機能一覧

### 2.1 コア機能

#### 2.1.1 イベント表示機能
- **機能ID**: F001
- **機能名**: イベント一覧表示
- **概要**: 岩手県内のイベント情報を一覧形式で表示
- **詳細**:
  - イベント名、開催日時、場所、概要を表示
  - イベントカード形式での視覚的表示
  - 開催日による自動ソート（直近順）
  - 無限スクロール対応

#### 2.1.2 地図表示機能
- **機能ID**: F002
- **機能名**: インタラクティブ地図
- **概要**: 岩手県の地図上にイベント位置をマーカーで表示
- **詳細**:
  - OpenStreetMap ベースの地図表示
  - イベント位置にピンマーカー表示
  - マーカークリックでイベント詳細ポップアップ
  - 地図のズーム・パン操作
  - 岩手県中心の初期表示設定

#### 2.1.3 イベント詳細表示
- **機能ID**: F003
- **機能名**: イベント詳細モーダル
- **概要**: 選択したイベントの詳細情報をモーダルウィンドウで表示
- **詳細**:
  - イベント名、詳細説明、開催日時
  - 開催場所（住所）
  - 主催者情報
  - 参加費、定員等の詳細情報
  - 外部リンク（公式サイト等）

### 2.2 検索・フィルタ機能

#### 2.2.1 カテゴリフィルタ
- **機能ID**: F004
- **機能名**: イベントカテゴリ絞り込み
- **概要**: イベントの種類によるフィルタリング
- **詳細**:
  - 文化・芸術、スポーツ、グルメ、自然・アウトドア等のカテゴリ
  - 複数カテゴリの同時選択可能
  - リアルタイムフィルタリング

#### 2.2.2 地域フィルタ
- **機能ID**: F005
- **機能名**: 開催地域絞り込み
- **概要**: 岩手県内の地域によるフィルタリング
- **詳細**:
  - 盛岡、一関、奥州、花巻、北上、久慈等の主要地域
  - 県央、県南、県北、沿岸部での大分類
  - 地域選択による地図表示範囲の自動調整

#### 2.2.3 日付フィルタ
- **機能ID**: F006
- **機能名**: 開催日絞り込み
- **概要**: イベント開催日による期間指定フィルタ
- **詳細**:
  - 今日、今週、今月、来月の定型フィルタ
  - カスタム日付範囲指定
  - 過去イベントの表示/非表示切り替え

#### 2.2.4 AI検索機能
- **機能ID**: F007
- **機能名**: 自然言語検索
- **概要**: Google Gemini AIを活用した自然言語によるイベント検索
- **詳細**:
  - 「子供向けの夏祭り」「アウトドアイベント」等の自然な検索
  - 検索クエリの意図理解と適切なイベント抽出
  - 検索結果のランキング表示

### 2.3 データ管理機能

#### 2.3.1 イベントデータ収集
- **機能ID**: F008
- **機能名**: 自動データ更新
- **概要**: 複数のソースからイベント情報を自動収集
- **詳細**:
  - 岩手県公式サイト、市町村サイト等からの情報取得
  - イベント情報の正規化・構造化
  - 重複イベントの検出と統合
  - データ更新ボタンによる手動更新

#### 2.3.2 データ品質管理
- **機能ID**: F009
- **機能名**: 情報精度保証
- **概要**: 収集したイベント情報の品質確保
- **詳細**:
  - 開催日時の検証
  - 住所情報の正規化
  - 重複・無効イベントの除外
  - データソースの信頼性評価

### 2.4 ユーザーインターフェース

#### 2.4.1 レスポンシブデザイン
- **機能ID**: F010
- **機能名**: マルチデバイス対応
- **概要**: PC、タブレット、スマートフォンでの最適表示
- **詳細**:
  - ブレークポイント: 640px, 768px, 1024px, 1280px
  - モバイルファーストデザイン
  - タッチ操作対応

#### 2.4.2 アクセシビリティ
- **機能ID**: F011
- **機能名**: アクセシブルUI
- **概要**: 障害を持つユーザーでも利用可能なインターフェース
- **詳細**:
  - キーボード操作対応
  - スクリーンリーダー対応
  - 色覚障害への配慮
  - WCAG 2.1 AA準拠

### 2.5 性能・運用機能

#### 2.5.1 高速表示
- **機能ID**: F012
- **機能名**: パフォーマンス最適化
- **概要**: 快適なユーザー体験のための高速表示
- **詳細**:
  - 遅延読み込み（Lazy Loading）
  - 画像最適化
  - バンドル分割
  - キャッシュ戦略

#### 2.5.2 エラーハンドリング
- **機能ID**: F013
- **機能名**: 堅牢なエラー処理
- **概要**: システム障害時の適切な処理とユーザー通知
- **詳細**:
  - API通信エラーの処理
  - ネットワーク障害時の表示
  - 再試行機能
  - フォールバック表示

## 3. 画面仕様

### 3.1 メイン画面
- **ヘッダー**: アプリ名、更新ボタン
- **サイドバー**: フィルタパネル、イベント一覧
- **メインパネル**: 地図表示エリア
- **モーダル**: イベント詳細表示

### 3.2 レイアウト構成
```
+------------------+
|      Header      |
+--------+---------+
|Sidebar | Map     |
|        | Panel   |
|        |         |
+--------+---------+
```

### 3.3 UI コンポーネント
- **EventCard**: イベント情報カード
- **MapPanel**: 地図表示パネル
- **EventDetailModal**: イベント詳細モーダル
- **FilterPanel**: フィルタ操作パネル
- **LoadingSpinner**: 読み込み表示

## 4. データ仕様

### 4.1 イベントデータ構造
```typescript
interface EventInfo {
  id: string;
  title: string;
  description: string;
  date: string;
  location: {
    name: string;
    address: string;
    coordinates: [number, number];
  };
  category: string;
  organizer: string;
  url?: string;
  price?: string;
  capacity?: number;
  source: string;
}
```

### 4.2 フィルタ状態管理
```typescript
interface FilterState {
  category: string[];
  area: string[];
  dateRange: {
    start: Date;
    end: Date;
  };
  searchQuery: string;
}
```

## 5. 外部連携仕様

### 5.1 Google Gemini AI API
- **用途**: 自然言語検索処理
- **入力**: ユーザー検索クエリ
- **出力**: 関連イベントIDリスト

### 5.2 OpenStreetMap
- **用途**: 地図タイル表示
- **ライブラリ**: Leaflet + React-Leaflet
- **表示範囲**: 岩手県全域

## 6. セキュリティ仕様

### 6.1 API セキュリティ
- GEMINI_API_KEY の環境変数管理
- HTTPS通信の強制
- CORS設定の適切な管理

### 6.2 フロントエンドセキュリティ
- XSS攻撃対策
- CSP (Content Security Policy) 設定
- 入力値サニタイゼーション

## 7. 品質保証

### 7.1 機能テスト項目
- [ ] イベント表示の正確性
- [ ] 地図機能の動作確認
- [ ] フィルタ機能の動作確認
- [ ] AI検索機能の精度確認
- [ ] レスポンシブデザインの確認

### 7.2 性能テスト項目
- [ ] ページロード時間（3秒以内）
- [ ] 地図操作のレスポンス
- [ ] 大量データ表示時の性能
- [ ] モバイル環境での動作

### 7.3 互換性テスト項目
- [ ] Chrome, Firefox, Safari, Edge での動作確認
- [ ] iOS Safari, Android Chrome での動作確認
- [ ] 異なる画面サイズでの表示確認

---

**文書作成日**: 2024年8月13日  
**文書バージョン**: 1.0  
**作成者**: システム開発チーム  
**承認者**: プロダクトオーナー